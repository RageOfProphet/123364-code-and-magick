{"version":3,"sources":["webpack:///webpack/bootstrap aca64a299f1fb97a1696?045e****","webpack:///./src/js/reviews.js"],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;ACtCA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,gBAAe,MAAM;AACrB;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA,UAAS;AACT;AACA,MAAK;;AAEL;AACA;AACA,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;;AAEA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;;AAEA;AACA,MAAK;;AAEL;AACA;AACA,gBAAe,OAAO;AACtB,kBAAiB;AACjB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,MAAK;;AAEL;AACA;AACA,gBAAe,OAAO;AACtB,kBAAiB;AACjB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,MAAK;;AAEL;AACA;AACA,gBAAe,QAAQ;AACvB,gBAAe,OAAO;AACtB,kBAAiB;AACjB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,QAAO;AACP;AACA;;AAEA;AACA;;AAEA;AACA,EAAC","file":"js/reviews.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap aca64a299f1fb97a1696\n **/","/**\n * Created by Dmitry Bezugly on 30.10.2016.\n */\n\n'use strict';\n\nwindow.reviewList = (function() {\n  var DATA_URL = 'http://localhost:1507/api/reviews';\n  var JSONP_FUNCTION_NAME = 'getData';\n  var IMAGE_LOAD_TIMEOUT = 10000;\n\n  var template = document.querySelector('#review-template');\n  var templateContainer = 'content' in template ? template.content : template;\n\n  var reviewList = {\n    /**\n     * Рендер отзывов\n     * @param {Array} data массив полученных с сервера данных\n     */\n    render: function(data) {\n      var reviews = data;\n\n      if (reviews.length > 0) {\n        this.showFilters();\n\n        var reviewListElement = document.querySelector('.reviews-list');\n\n        reviews.forEach(function(item) {\n          reviewListElement.appendChild(reviewList.createReview(item));\n        });\n      }\n    },\n\n    /**\n     * Отправка запроса на сервер и получание массива отзывов\n     * @param {String} url адрес запроса\n     * @param {String} callbackName название функции\n     */\n    getReviewsData: function(url, callbackName) {\n      window[callbackName] = function(data) {\n        reviewList.render(data);\n      };\n\n      var script = document.createElement('script');\n      script.src = url + '?callback=' + callbackName;\n      document.body.appendChild(script);\n    },\n\n    /**\n     * Скрытие блока с фильтрами\n     */\n    hideFilters: function() {\n      var filters = document.querySelector('.reviews-filter');\n\n      filters.classList.add('invisible');\n    },\n\n    /**\n     * Появление блока с фильтрами\n     */\n    showFilters: function() {\n      var filters = document.querySelector('.reviews-filter');\n\n      filters.classList.remove('invisible');\n    },\n\n    /**\n     * Создание отзыва\n     * @param {Object} reviewItemData данные по отзыву\n     * @returns {Element}\n     */\n    createReview: function(reviewItemData) {\n      var reviewElement = templateContainer.querySelector('.review').cloneNode(true);\n      var reviewText = reviewElement.querySelector('.review-text');\n      var reviewRating = reviewElement.querySelector('.review-rating');\n\n      this.fillImage(reviewElement, reviewItemData);\n      reviewRating.classList.add(this.getRatingClass(reviewItemData.rating));\n      reviewText.textContent = reviewItemData.description;\n\n      return reviewElement;\n    },\n\n    /**\n     * Получение класса для рейтинга\n     * @param {Number} stars\n     * @returns {String}\n     */\n    getRatingClass: function(stars) {\n      var className = '';\n\n      switch (stars) {\n        case 1:\n          className = 'review-rating-one';\n          break;\n        case 2:\n          className = 'review-rating-two';\n          break;\n        case 3:\n          className = 'review-rating-three';\n          break;\n        case 4:\n          className = 'review-rating-four';\n          break;\n        case 5:\n          className = 'review-rating-five';\n          break;\n        default:\n          break;\n      }\n\n      return className;\n    },\n\n    /**\n     * Заполнение картинки\n     * @param {Element} reviewContainer контейнер с отзывом\n     * @param {Object} reviewData данные с сервера\n     * @returns {Element}\n     */\n    fillImage: function(reviewContainer, reviewData) {\n      var image = new Image(124, 124);\n      var imageTimeout = null;\n      var reviewImage = reviewContainer.querySelector('.review-author');\n\n      image.onload = function() {\n        clearTimeout(imageTimeout);\n        reviewImage.src = reviewData.author.picture;\n      };\n\n      image.onerror = function() {\n        reviewContainer.classList.add('review-load-failure');\n      };\n\n      image.src = reviewData.author.picture;\n      reviewImage.alt = reviewData.author.name;\n      reviewImage.title = reviewData.author.name;\n\n      imageTimeout = setTimeout(function() {\n        image.src = '';\n        reviewContainer.classList.add('review-load-failure');\n      }, IMAGE_LOAD_TIMEOUT);\n    }\n  };\n\n  reviewList.hideFilters();\n  reviewList.getReviewsData(DATA_URL, JSONP_FUNCTION_NAME);\n\n  return reviewList;\n})();\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/js/reviews.js\n ** module id = 0\n ** module chunks = 5\n **/"],"sourceRoot":""}